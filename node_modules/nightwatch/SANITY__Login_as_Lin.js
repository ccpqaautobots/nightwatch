/* jshint expr: true */
module.exports = {
  tags: ['Core Front End'],
  before: function (browser) {
	  browser.windowMaximize('current');
  },
  'SANITY__Login_as_Lin' : function (sanity) {
    sanity
     .url('http://corepreview:previewphase@core-cms.si.aop.cambridge.org/core/')
	 ///.url('http://core-cms.pen.aop.cambridge.org/core/')
      .pause(1000);
	sanity.waitForElementVisible('body',20000);
   	sanity.element('xpath', "//a[@class='cookie-close']", function(result){
	if (result.status !=-1)
			sanity.useXpath().click("*//a[@class='cookie-close']").pause(5000);
	}), 
	sanity.element('xpath', "//a[@class='browser-message-close']", function(result){		
	if (result.status !=-1)
			sanity.useXpath().click("*//a[@class='browser-message-close']").pause(5000);	
	}), 	
	sanity.useXpath().click("*//li[5]/a[contains(.,'Log in')]").pause(5000);
	sanity.useCss().setValue('#username', 'autocorelin@cambridge.org').pause(500);
	sanity.useCss().setValue('#password', 'Password1').pause(500);
	sanity.useXpath().click("*//button[contains(.,'Log in')]").pause(5000);
	
	sanity.useXpath().moveToElement("//a[contains(@id,'r-user-dropdown-icon')]", 5000,5000);
	sanity.useXpath().click("//a[contains(@id,'r-user-dropdown-icon')]").pause(5000);
	sanity.useXpath().click("//a[contains(@id,'r-user-dropdown-icon')]").pause(5000);
	sanity.useXpath().waitForElementVisible("*//p[contains(.,'Logged in as Lin P')]",20000);
		
	sanity.useXpath().click("*//ul[2]/li[5]/a[contains(.,'My account')]").pause(5000);
	sanity.useXpath().expect.element("*//ul[1]/li[1]/a[contains(.,'Home')]").to.be.visible;
	sanity.useXpath().expect.element("*//ul[1]/li[2]/a[contains(.,'Access and authentication')]").to.be.visible;
	sanity.useXpath().expect.element("*//ul[1]/li[4]/a[contains(.,'Education')]").to.be.visible;
	sanity.useXpath().expect.element("*//ul[1]/li[5]/a[contains(.,'Content requests')]").to.be.visible;
	sanity.useXpath().expect.element("*//ul[1]/li[6]/a[contains(.,'Content holdings')]").to.be.visible;
	sanity.useXpath().expect.element("*//ul[1]/li[7]/a[contains(.,'Marketing support')]").to.be.visible;
	sanity.useXpath().expect.element("*//ul[1]/li[8]/a[contains(.,'Usage statistics')]").to.be.visible;
	sanity.useXpath().expect.element("*//ul[1]/li[9]/a[contains(.,'User guides and training')]").to.be.visible;
	sanity.end();
  },
  after:function(browser) {
	  browser.end();
  }
};
